<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calvins Character Creator</title>
<style>
body { font-family: Arial, sans-serif; background-color: #f2f2f2; padding: 20px; }
.container { max-width: 800px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.2); }
h1 { text-align: center; }
select, button { padding: 10px; margin: 10px 0; width: 100%; }
.character-sheet { background: #eaeaea; padding: 10px; border-radius: 5px; margin-top: 10px; }
.stat-choice { margin: 5px 0; }
#raceInfo, #classInfo { background: #ddd; padding: 10px; border-radius: 5px; margin-top: 10px; }
.bonus { color: green; font-weight: bold; }
.penalty { color: red; font-weight: bold; }
.stat-table { border-collapse: collapse; width: 100%; margin-top: 10px; }
.stat-table td, .stat-table th { border: 1px solid #999; padding: 5px; text-align: center; }
.stat-table th { background-color: #bbb; }
</style>
</head>
<body>
<div class="container">
    <h1>Calvins Character Creator</h1>
    
    <label for="raceSelect">Choose a Race:</label>
    <select id="raceSelect">
        <option value="">--Select Race--</option>
        <option value="Weakling">Weakling</option>
        <option value="Mutant">Mutant</option>
        <option value="Synth">Synth</option>
        <option value="Beast">Beast</option>
        <option value="Nomad">Nomad</option>
        <option value="Ghostborn">Ghostborn</option>
        <option value="Wasteling">Wasteling</option>
        <option value="Revenant">Revenant</option>
        <option value="Scrapling">Scrapling</option>
        <option value="Ashborn">Ashborn</option>
        <option value="Ancient">Ancient</option>
        <option value="Brain">Brain</option>
        <option value="Skinny">Skinny</option>
    </select>

    <div id="humanStats" style="display:none;">
        <p>Select 2 stats to get +1 bonus each:</p>
        <label class="stat-choice"><input type="checkbox" value="STR"> STR</label>
        <label class="stat-choice"><input type="checkbox" value="DEX"> DEX</label>
        <label class="stat-choice"><input type="checkbox" value="CON"> CON</label>
        <label class="stat-choice"><input type="checkbox" value="INT"> INT</label>
        <label class="stat-choice"><input type="checkbox" value="WIS"> WIS</label>
        <label class="stat-choice"><input type="checkbox" value="CHA"> CHA</label>
    </div>

    <div id="raceInfo"></div>

    <label for="classSelect">Choose a Class:</label>
    <select id="classSelect">
        <option value="">--Select Class--</option>
        <option value="Alchemist">Alchemist</option>
        <option value="Scanner">Scanner</option>
        <option value="Knight">Knight</option>
        <option value="Engineer">Engineer</option>
        <option value="Pyro">Pyro</option>
        <option value="Medic">Medic</option>
        <option value="Cultist">Cultist</option>
        <option value="Spider">Spider</option>
        <option value="Cyborg">Cyborg</option>
        <option value="Controller">Controller</option>
        <option value="Machine">Machine</option>
        <option value="Prisoner">Prisoner</option>
        <option value="Necromancer">Necromancer</option>
        <option value="Harbinger">Harbinger</option>
        <option value="Sniper">Sniper</option>
    </select>

    <div id="classInfo"></div>

    <div id="prisonerCountry" style="display:none; margin-top:10px;">
        <label for="countrySelect"><strong>What country did you escape from?</strong></label>
        <select id="countrySelect">
            <option value="">--Select Country--</option>
            <option value="USA">USA</option>
            <option value="Russia">Russia</option>
            <option value="Japan">Japan</option>
            <option value="China">China</option>
            <option value="Australia">Australia</option>
            <option value="Europe">Europe</option>
        </select>
    </div>

    <button id="createCharacter">Create Character</button>

    <div id="characterSheet" class="character-sheet"></div>
</div>

<script>
const races = {
    "Weakling": { "Description": "Versatile and adaptable, but very vulnerable to the elements.", "Bonuses": {STR:0, DEX:0, CON:0, INT:0, WIS:0, CHA:0}, "Abilities":"None" },
    "Mutant": { "Description": "Mutants are experiments of the Russian Federation, humans mutated through exposure to chemicals, radiation, and genetic modification. They are large, brutish, and unintelligent, but are strong and tough.", "Bonuses": {STR:2, CON:2, INT:-1, WIS:-1}, "Abilities":"Resistance to chemicals and radiation" },
    "Synth": { "Description": "Artificially augmented humans, combining biology and cybernetics.", "Bonuses": {INT:2, DEX:1, CON:-1}, "Abilities":"Can interface with machines, minor hacking bonuses, immunity to certain electronic interference" },
    "Beast": { "Description": "Humanoids with animalistic traits, heightened senses, and primal instincts.", "Bonuses": {DEX:2, STR:1, CHA:-1}, "Abilities":"Night vision, enhanced smell/hearing, natural claw attack" },
    "Nomad": { "Description": "Survivors adapted to wandering harsh wastelands.", "Bonuses": {WIS:2, CON:1, INT:-1}, "Abilities":"Bonuses to survival, tracking, and movement over long distances" },
    "Ghostborn": { "Description": "Humans mutated with psychic potential after radiation exposure.", "Bonuses": {INT:2, CHA:1, STR:-1}, "Abilities":"Minor telepathy, detection of hidden threats, can sense danger zones; vulnerable to fear and psychic attacks" },
    "Wasteling": { "Description": "Humans who have grown up entirely in the wasteland, hardened and adaptable.", "Bonuses": {WIS:2, DEX:1, CHA:-1}, "Abilities":"Adaptation to extreme environments, bonuses to scavenging and survival checks" },
    "Revenant": { "Description": "Humans brought back from the brink of death with cybernetic or alchemical enhancements.", "Bonuses": {CON:2, INT:1, CHA:-1}, "Abilities":"Limited regeneration, resistance to disease/poison, slower movement" },
    "Scrapling": { "Description": "Tiny scavenger humanoids; quick and clever.", "Bonuses": {DEX:2, INT:1, STR:-1}, "Abilities":"Bonuses to crafting and scavenging" },
    "Ashborn": { "Description": "Survivors of nuclear fallout; resilient and wary.", "Bonuses": {CON:2, WIS:1, CHA:-1}, "Abilities":"Resistant to fire and radiation, slight intimidation aura" },
    "Ancient": { "Description": "Never trust an old man in a profession where men die young.", "Bonuses": {STR:-2, CON:-2, CHA:2, WIS:4}, "Abilities":"Wisdom modifies skills instead of INT" },
    "Brain": { "Description": "Simply a human brain, nothing more.", "Bonuses": {STR:-12, DEX:-12, CON:-12, INT:-12, WIS:-12, CHA:-12}, "Abilities":"None" },
    "Skinny": { "Description": "Rat-like survivors who thrive in filth and shadows. Quick, wiry, and always scheming.", "Bonuses": {DEX:2, INT:1, STR:-1, CON:-1}, "Abilities":"Can squeeze through tight spaces, advantage on scavenging in ruined areas" }
};

const classes = {
    "Alchemist": { "Stats":{"STR":10,"DEX":12,"CON":10,"INT":14,"WIS":12,"CHA":10}, "StartingGear":"Parka, AK-47, Gas Mask", "Abilities":"Uses potions, chemicals, and improvised tools." },
    "Scanner": { "Stats":{"STR":8,"DEX":12,"CON":10,"INT":14,"WIS":14,"CHA":10}, "StartingGear":"Scanning Rig Headgear, Heavy Brown Coat, MP5 SMG", "Abilities":"Detects enemies, hacks devices, and gathers info." },
    "Knight": { "Stats":{"STR":14,"DEX":10,"CON":14,"INT":8,"WIS":10,"CHA":10}, "StartingGear":"Rusty Power Armor, Sword, SCAR 50 Cal", "Abilities":"Frontline fighter with heavy armor and weapons." },
    "Engineer": { "Stats":{"STR":10,"DEX":12,"CON":12,"INT":14,"WIS":10,"CHA":10}, "StartingGear":"Automatic Shotgun, Broken Gauss Rifle, Armored Heavy Coat", "Abilities":"Repairs, modifies, and builds gadgets and weapons." },
    "Pyro": { "Stats":{"STR":10,"DEX":14,"CON":12,"INT":10,"WIS":10,"CHA":10}, "StartingGear":"Flamethrower, Molotovs, Light SMG or Pistol, Fireproof Jacket", "Abilities":"Specializes in fire and explosives." },
    "Medic": { "Stats":{"STR":10,"DEX":10,"CON":16,"INT":12,"WIS":12,"CHA":10}, "StartingGear":"M4 Rifle, Combat Knife, First Aid Kits, Medical Toolkit", "Abilities":"Heals and revives teammates." },
    "Cultist": { "Stats":{"STR":10,"DEX":10,"CON":12,"INT":10,"WIS":14,"CHA":10}, "StartingGear":"AK-47, Plague Mask, Ritual Blade, Tattered Robes, Incense Kit", "Abilities":"Uses rituals and plagues to affect enemies and allies." },
    "Spider": { "Stats":{"STR":10,"DEX":14,"CON":12,"INT":10,"WIS":12,"CHA":10}, "StartingGear":"SMG or Pistol, Sniper Rifle (not heavy), Cyborg Spider Legs, Light Armor", "Abilities":"Fast and mobile; can climb walls and strike stealthily." },
    "Cyborg": { "Stats":{"STR":16,"DEX":8,"CON":14,"INT":8,"WIS":10,"CHA":8}, "StartingGear":"Rusty Minigun, Heavy Armor", "Abilities":"Strong and heavily armored, carries heavy weapons." },
    "Prisoner": {
        "Stats": {}, 
        "StartingGear": "Broken Bindings (wristwear)",
        "Abilities": "Escaped from a country and carries knowledge, weapons, and armor from that place. Gains different stats and gear depending on choice.",
        "CountryOptions": {
            "USA": { "Stats": {"STR":12,"DEX":11,"CON":11,"INT":10,"WIS":10,"CHA":10}, "Gear": "M16, Kevlar Vest, American Plans, Combat Boots" },
            "Russia": { "Stats": {"STR":12,"DEX":10,"CON":12,"INT":10,"WIS":9,"CHA":10}, "Gear": "RPK, Russian Plans, Parka" },
            "Japan": { "Stats": {"STR":9,"DEX":12,"CON":10,"INT":12,"WIS":10,"CHA":10}, "Gear": "Matrix Hard Drive, Katana" },
            "China": { "Stats": {"STR":10,"DEX":11,"CON":11,"INT":12,"WIS":10,"CHA":10}, "Gear": "Type 95 Automatic Rifle, Chinese Plans, Red Coat" },
            "Australia": { "Stats": {"STR":11,"DEX":11,"CON":10,"INT":10,"WIS":10,"CHA":12}, "Gear": "Pirate Plans, Pirate Hat, Cutlass, Grenade Pistol" },
            "Europe": { "Stats": {"STR":10,"DEX":9,"CON":10,"INT":10,"WIS":12,"CHA":12}, "Gear": "FN FAL, European Plans, Wool Cloak" }
        },
        "CountryPrompt": "What country did you escape from?"
    },
    "Controller": { "Stats":{"STR":10,"DEX":12,"CON":12,"INT":14,"WIS":12,"CHA":10}, "StartingGear":"M16 rifle, Deployable Turret, Claymores (x3), Energy Shield Device, Portable Radar, Trench coat", "Abilities":"Sets up turrets, traps, and shields to control areas." },
    "Machine": {
        "Stats": {"STR":30,"DEX":15,"CON":30,"INT":17,"WIS":18,"CHA":10},
        "StartingGear":"Belt-fed Heavy Machine Gun, Grenade Launcher",
        "Abilities":"Walking mech about as tall as two humans. Only compatible with Brain. Can move and fire once every other turn.",
        "SpecialNotes":"Only one Machine per group. If you claim the Machine, text the chat so we know you have claimed it.",
        "AttachPoints": { "Energy": 1,"LightMG": 1,"HeavyMG": 1,"Rocket": 1,"GrenadeLauncher": 1,"Melee": 1,"LargeItem": 1 }
    },
    "Necromancer": { "Stats":{"STR":8,"DEX":10,"CON":12,"INT":16,"WIS":14,"CHA":12}, "StartingGear":"Bloody Medical Scrubs, Ak-47, Surgical Knife", "Abilities":"Collects biomass to create tools such as replacement organs, golems, and bioluminescent lights and sensors" },
    "Harbinger": { "Stats":{"STR":14,"DEX":12,"CON":14,"INT":10,"WIS":12,"CHA":8}, "StartingGear":"Dark Cloak, Heavy Blade, Revolver, Musical instrument of choice", "Abilities":"Spreads fear, demoralizes foes, encourages allies with music" },
    "Sniper": { "Stats":{"STR":10,"DEX":14,"CON":12,"INT":15,"WIS":12,"CHA":10}, "StartingGear":"Sniper Rifle, Combat Knife, Recon Drone", "Abilities":"Veteran sniper with advanced knowledge of enemy weak points; can deploy drones." }
};

// Stat modifier calculation
function calcModifier(stat) { return Math.floor((stat - 10)/2); }

// Race info display
document.getElementById('raceSelect').addEventListener('change', () => {
    const selectedRace = document.getElementById('raceSelect').value;
    const humanStatsDiv = document.getElementById('humanStats');
    const raceInfoDiv = document.getElementById('raceInfo');

    if(selectedRace && races[selectedRace]) {
        let bonusesText = '';
        for(const [stat, val] of Object.entries(races[selectedRace].Bonuses)) {
            if(val > 0) bonusesText += `<span class="bonus">+${val} ${stat}</span> `;
            else if(val < 0) bonusesText += `<span class="penalty">${val} ${stat}</span> `;
        }
        raceInfoDiv.innerHTML = `<strong>Description:</strong> ${races[selectedRace].Description}<br>
                                 <strong>Bonuses:</strong> ${bonusesText}<br>
                                 <strong>Abilities:</strong> ${races[selectedRace].Abilities || 'None'}`;
    } else { raceInfoDiv.innerHTML = ''; }

    if(selectedRace === "Weakling") humanStatsDiv.style.display = "block";
    else { humanStatsDiv.style.display = "none"; document.querySelectorAll('#humanStats input').forEach(cb => cb.checked = false); }
});

// Class info display
document.getElementById('classSelect').addEventListener('change', () => {
    const selectedClass = document.getElementById('classSelect').value;
    const classInfoDiv = document.getElementById('classInfo');

    if (selectedClass === "Prisoner") {
        document.getElementById("prisonerCountry").style.display = "block";
    } else {
        document.getElementById("prisonerCountry").style.display = "none";
    }

    if(selectedClass && classes[selectedClass]) {
        const c = classes[selectedClass];

        if(selectedClass === "Machine" && document.getElementById('raceSelect').value !== "Brain") {
            classInfoDiv.innerHTML = `<span style="color:red;">Machine class is only compatible with Brain race.</span>`;
            return;
        }

        if(selectedClass === "Machine") {
            let attachText = '';
            for(const [point, count] of Object.entries(c.AttachPoints)) {
                attachText += `- ${point.replace(/([A-Z])/g, ' $1')}: ${count}<br>`;
            }
            classInfoDiv.innerHTML = `<strong>${c.SpecialNotes}</strong><br>
                                      <strong>Abilities:</strong> ${c.Abilities}<br>
                                      <strong>Attach Points:</strong><br>${attachText}
                                      <strong>Starting Gear:</strong> ${c.StartingGear}`;
        } else {
            classInfoDiv.innerHTML = `<strong>Abilities:</strong> ${c.Abilities}<br>
                                      <strong>Starting Gear:</strong> ${c.StartingGear}`;
        }
    } else { classInfoDiv.innerHTML = ''; }
});

// Character creation
document.getElementById('createCharacter').addEventListener('click', () => {
    const race = document.getElementById('raceSelect').value;
    const cls = document.getElementById('classSelect').value;
    const country = document.getElementById('countrySelect').value;
    const sheetDiv = document.getElementById('characterSheet');

    if (!race || !cls) { 
        alert("Please select both race and class."); 
        return; 
    }

    let stats = {};
    let gear = "";
    let abilities = "";

    if (cls === "Prisoner") {
        if (!country || !classes.Prisoner.CountryOptions[country]) {
            alert("Select a valid country for Prisoner.");
            return;
        }
        // Base stats from country
        stats = {...classes.Prisoner.CountryOptions[country].Stats};
        gear = classes.Prisoner.StartingGear + ", " + classes.Prisoner.CountryOptions[country].Gear;
        abilities = classes.Prisoner.Abilities;
    } else {
        stats = {...classes[cls].Stats};
        gear = classes[cls].StartingGear;
        abilities = classes[cls].Abilities;
    }

    // Apply racial bonuses for all characters including Prisoner
    const raceBonuses = {...races[race].Bonuses};
    for (const stat in stats) {
        if (raceBonuses[stat]) stats[stat] += raceBonuses[stat];
    }

    // Weakling +1 selections
    if (race === "Weakling") {
        document.querySelectorAll('#humanStats input:checked').forEach(cb => {
            if (stats[cb.value] !== undefined) stats[cb.value] += 1;
        });
    }

    // Merge abilities (class + racial)
    if (races[race].Abilities) {
        abilities += " | Racial: " + races[race].Abilities;
    }

    // Generate stat table
    let statHTML = '<table class="stat-table"><tr><th>Stat</th><th>Value</th><th>Modifier</th></tr>';
    for (const [stat, val] of Object.entries(stats)) {
        const mod = calcModifier(val);
        statHTML += `<tr><td>${stat}</td><td>${val}</td><td>${mod >= 0 ? '+' : ''}${mod}</td></tr>`;
    }
    statHTML += '</table>';

    // Display character sheet
    sheetDiv.innerHTML = `<h2>${race} ${cls}${cls === "Prisoner" ? " of " + country : ""}</h2>
                          ${statHTML}
                          <strong>Starting Gear:</strong> ${gear}<br>
                          <strong>Abilities:</strong> ${abilities}`;
});
</script>
</body>
</html>
